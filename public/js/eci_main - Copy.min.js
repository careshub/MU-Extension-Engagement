var map;jQuery(document).ready(function(n){function i(t,i,r,u,f){i=/^http/i.test(i)?i:"https://services.engagementnetwork.org/"+i;var e={type:t,url:i,dataType:"json",contentType:"application/json; charset=utf-8",crossDomain:!0,success:u,error:f||n.noop};r&&typeof r!="undefined"&&(t==="post"?e.data=JSON.stringify(r):e.url+="?"+n.param(r));n.ajax(e)}var t={map:"impact-map",cssGeog:".ecpp-geog",selectcssGeogID:"filters-container-regions",filterGeog:"#filter-geography",filters:["theme","type","affiliation"],igeog:0,geoid:[],geog:[{geo_key:"050",layer_ids:[4,5],select_ids:[6,7]},{geo_key:"970",layer_ids:[24,25],select_ids:[26,27]},{geo_key:"610",layer_ids:[36,37],select_ids:[38,39]},{geo_key:"620",layer_ids:[32,33],select_ids:[34,35]},{geo_key:"500",layer_ids:[40,41],select_ids:[42,43]}]},r,o,u,w,b;if(n("#"+t.map).length){map=L.map(t.map,{attributionControl:!1,minZoom:7,maxZoom:13,loadingControl:!0,scrollWheelZoom:!1}).setView([38.333,-92.34],7);L.esri.tiledMapLayer({url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"}).addTo(map);t.bounds=map.getBounds();map.setMaxBounds(t.bounds);w=L.Control.extend({options:{position:"topleft"},onAdd:function(n){var i=L.DomUtil.create("div","leaflet-bar leaflet-control leaflet-control-custom");return i.onclick=function(i){n.flyToBounds(t.bounds);i.stopPropagation()},i}});map.addControl(new w);vt();b=L.esri.Geocoding.geocodeService();bt();n("#"+t.selectcssGeogID).on("change",function(){var i=parseInt(n("#"+t.selectcssGeogID).val());k(t.geog[i].layer_name);n(t.cssGeog).removeClass("active");n(t.cssGeog+":eq("+i+")").addClass("active")});n(t.cssGeog).on("click",function(){n(t.cssGeog).removeClass("active");n(this).addClass("active");var i=n(this).html();i=n.trim(i);k(i)});map.on("click",function(n){nt(n.latlng)});n("#address-search").on("click",at);n("#address-input").on("keyup",function(n){n.keyCode==13&&at()});n("#list-geography").on("change",function(){var i=n(this).val();i!==""&&n.inArray(i,t.geoid)===-1&&r.query().layer(t.geog[t.igeog].select_ids[0]).within(t.bounds).where("GEOID = '"+i+"'").run(function(n,t){s(t)})});n("#list-view").on("click",function(){n("#grid-view").removeClass("active");n("#engage-list .single-engagement").addClass("list-group-item");n("#impact-list .single-engagement").addClass("list-group-item");n(this).addClass("active")});n("#grid-view").on("click",function(){n("#list-view").removeClass("active");n("#engage-list .single-engagement").removeClass("list-group-item").addClass("grid-group-item");n(this).addClass("active");n("#impact-list .single-engagement").removeClass("list-group-item").addClass("grid-group-item")});function k(i){map.flyToBounds(t.bounds);n.each(t.geog,function(u,f){if(f.layer_name===i)return t.igeog!==u&&(t.selectionBounds&&delete t.selectionBounds,n("#impact-list").empty(),t.igeog=u,t.geoid=[],it(),c(),r.setLayerDefs(d()),r.setLayers(f.select_ids),g(),n(t.filterGeog).empty(),n("#filter-help").show()),!1})}function vt(){var i,u;n(t.cssGeog).each(function(i,r){t.geog[i].layer_name=n.trim(n(r).html());n("#"+t.selectcssGeogID).append(n("<option />",{text:t.geog[i].layer_name,value:i}))});n("#"+t.selectcssGeogID).val(t.igeog);it();c();i="https://gis3.cares.missouri.edu/arcgis/rest/services/Dynamic/Boundary2016_ECI/MapServer";r=L.esri.dynamicMapLayer({url:i,layers:t.geog[t.igeog].select_ids,layerDefs:d(),format:"png32",opacity:1,position:"front"}).addTo(map);u=L.esri.tiledMapLayer({url:"https://server.arcgisonline.com/arcgis/rest/services/Reference/World_Reference_Overlay/MapServer",maxZoom:13}).addTo(map);map.getPanes().shadowPane.appendChild(u.getContainer());g()}function d(){var i={};return n.each(t.geog,function(n,t){if(t.select_ids)for(var r=0;r<t.select_ids.length;r++)i[t.select_ids[r]]="GEOID IN ('')"}),i}function g(){var r=t.geog[t.igeog].layer_name,u=t.geog[t.igeog].geo_key;i("get","api-location/v1/geoid-list/"+u,{state:"Missouri"},function(t){t&&(r=u==="500"?"Cong. District":r,n("#list-geography").empty().append(n("<option />",{text:"- Select "+r+" -",value:""})),n.each(t,function(t,i){n("#list-geography").append(n("<option />",{value:i.geoid,text:i.name}))}))})}function nt(n){r.identify().at(n).on(map).layers("visible:"+t.geog[t.igeog].select_ids.join(",")).run(function(n,t){s(t)})}function s(i){var l=t.geog[t.igeog],o,u,h,f;if(i&&i.features.length>0){n("#filter-help").hide();var e=!1,a=n("#list-view").hasClass("active")?" list-group-item":"",v=y("images"),p=y("pdf")+t.geog[t.igeog].layer_name.toLowerCase()+"/";if(n.each(i.features,function(i,r){var u=r.properties.GEOID||r.properties.GeoID,f,h,o;if(/(^29|US29)/.test(u)&&n.inArray(u,t.geoid)===-1){t.geoid.push(u);f=r.properties.Name||r.properties.NAMELSAD;h=ct({title:f,link:p+f+".pdf",image:v+"um_impact.png"},u,a,!0);n("#impact-list").append(h);t.count&&t.count[u]&&(f+=" ("+t.count[u]+")");o=n("<li />",{"data-id":u}).append(n("<i />",{"class":"fa fa-times-circle fa-2x"})).append(n("<span />").append(f));n(t.filterGeog).append(o);o.find("i").on("click",function(){var r=n(this).parent("li"),u=r.attr("data-id"),i,f;for(r.remove(),i=0;i<t.geoid.length;i++)if(t.geoid[i]===u){t.geoid.splice(i,1);t.geoid.length===0?(delete t.selectionBounds,map.flyToBounds(t.bounds)):(f=t.geog[t.igeog].select_ids[1],tt(f,t.geoid,function(n){var i=L.geoJSON(n);t.selectionBounds=i.getBounds();map.flyToBounds(t.selectionBounds)}));t.igeog!==1&&n("#impact-list").find(".single-engagement[data-id='"+u+"']").parent().remove();s();break}t.geoid.length===0&&n("#list-geography").val("")});e=!0}}),!e)return}return o="GEOID IN ('"+t.geoid.join("','")+"')",u={},n.each(l.select_ids,function(n,t){u[t]=o}),r&&(r.setLayerDefs(u),i&&(h=L.geoJSON(i),f=h.getBounds(),t.selectionBounds?t.selectionBounds.extend(f):t.selectionBounds=f,map.flyToBounds(t.selectionBounds))),c(),u}function tt(i,r,u){var f=r?"GEOID IN ('"+r.join("','")+"')":"";L.esri.query({url:"https://gis3.cares.missouri.edu/arcgis/rest/services/Dynamic/Boundary2016_ECI/MapServer",useCors:!0}).layer(i).within(t.bounds).where(f).run(function(t,i){u=u||n.noop;u(i)})}function it(){o&&(o.remove(),u.remove());tt(t.geog[t.igeog].layer_ids[1],null,function(r){r&&r.features.length&&i("get","api-extension/v1/eci-counts/"+t.geog[t.igeog].geo_key,null,function(i){var e,h,f,l,a;if(t.count=i,t.colors)rt();else{t.colors={ramp:[[98,8,82],[209,186,208]],grades:[]};rt();var c=t.colors.grades.length-1,s=t.colors.ramp[0],v=t.colors.ramp[1];for(e=1;e<c;e++){for(h=[],f=0;f<s.length;f++)l=s[f]+e/c*(v[f]-s[f]),h.push(Math.round(l));t.colors.ramp.splice(e,0,h)}t.colors.ramp=n.map(t.colors.ramp,function(n){return"RGB("+n.join(",")+")"})}n.each(r.features,function(n,t){var r=t.properties.GEOID||t.properties.GeoID;t.properties.count=i[r]});r.features.sort(function(n,t){return n.properties.count<t.properties.count?-1:n.properties.count>t.properties.count?1:0});a=function(n){var t=ut(n.properties.count);return{fillColor:t,fillOpacity:.7,weight:1,color:t,opacity:1}};o=L.geoJSON(r,{style:a}).addTo(map);u=L.control({position:"bottomleft"});u.onAdd=function(){for(var u,r=L.DomUtil.create("div","info legend"),i=t.colors.grades,n=0;n<i.length;n++)r.innerHTML+='<i style="background:'+ut(i[n]+1)+'"><\/i>',u=i[n]==i[n+1]-1?i[n+1]+"<\/span><br>":i[n]+1+(i[n+1]?"&ndash;"+i[n+1]+"<\/span><br>":"+<\/span>"),r.innerHTML+="<span>"+u;return r};u.addTo(map)})})}function rt(){var u=[],f,n,r,i;for(f in t.count)u.push(t.count[f]);for(n=new classyBrew,n.setSeries(u),n.setNumClasses(4),r=n.classify(),t.colors.grades=[0],i=0;i<r.length-1;i++)t.colors.grades.push(r[i])}function ut(n){for(var r=t.colors.ramp.length-1,i=r;i>=0;i--)if(n>t.colors.grades[i])return t.colors.ramp[r-i];return t.colors.ramp[r]}function kt(n){var t=n.target;t.setStyle({weight:2,color:"#ff0000"});L.Browser.ie||L.Browser.opera||L.Browser.edge||t.bringToFront()}function dt(n){map.fitBounds(n.target.getBounds())}function gt(n,t){if(n.properties){var i=n.properties.NAMELSAD||n.properties.Name,r=n.properties.count;i="<b>"+i+"<\/b>: "+r;t.bindPopup(i)}}function h(n){return n.replace(/ /g,"_").toLowerCase()}function c(){var r=t.geoid.length>0;t.posts={engagements:{},viewed:[]};n.each(t.filters,function(n,i){t.posts[i]={}});e(t.posts,r);r?i("get","api-extension/v1/eci-geoid-list",{geoid:t.geoid.join(",")},function(t){var i=["04000US29","01000US"];n.merge(i,t);ft(i,1)}):t.summary?e(t.summary):(t.summary={},f(1,"muext_program_category",t.filters[0]));lt()}function f(r,u,o){var c="https://engagements.missouri.edu/wp-json/wp/v2/"+u,s=100,h={parent:0,per_page:s,page:r,orderby:"id"};o===t.filters[0]&&(h.exclude=2);i("get",c,h,function(i){t.summary[o]=t.summary[o]||{};n.each(i,function(n,i){i.count>0&&(t.summary[o][i.name]=i.count)});i.length<s?(r=1,t.summary.type?t.summary.affiliation?t.geoid&&t.geoid.length!==0||e(t.summary):f(r,"muext_program_affiliation",t.filters[2]):f(r,"muext_program_outreach_type",t.filters[1])):(r++,f(r,u,o))})}function ft(r,u){var f=100;i("get","https://engagements.missouri.edu/wp-json/wp/v2/muext_engagement",{"filter[muext_geoid]":r.join(","),"filter[posts_per_page]":f,page:u},function(i){console.log(i);n.each(i,function(n,i){t.posts.engagements[i.id]={title:i.title.rendered,link:i.link,image:i.eng_featured_image};v(i.eng_theme["top-level"],t.filters[0],i.id);v(i.eng_type["top-level"],t.filters[1],i.id);v(i.eng_affiliation["top-level"],t.filters[2],i.id)});i.length<f?(console.log(t.posts),e(t.posts)):(u++,ft(r,u))})}function ni(n){var t="https://engagements.missouri.edu/wp-json/wp/v2/engagement-contentmeta/"+n;i("get",t,function(n){console.log(n)})}function l(i,r,u){var f,u,e;r&&r==!0&&(t.posts.viewed=[]);t.posts.viewed.push(i);u||(f=n(".single-engagement[data-id='"+i+"']"),u=f.attr("data-theme"),console.log(f));e=n.ajax({url:eci_ajax.ajax_url,data:{action:"ajax_single_card",post_id:i},method:"POST",dataType:"html",beforeSend:function(){},success:function(){}}).done(function(t){var s,h,e,r,o,f;if(console.log(u),t=n.trim(t),s=n(t)[0],h=n(t)[2],n("#single-engagement-modal .modal-title").html(s),n("#single-engagement-modal .modal-theme").html("Impact Area: "+u),n("#single-engagement-modal .modal-main").html(h),e=a(i,u),r=n("#single-engagement-modal .next-btn"),e==0)r.addClass("hidden");else{r.removeClass("hidden");r.off("click");r.on("click",function(){l(e,!0,u)})}if(o=yt(i,u),f=n("#single-engagement-modal .prev-btn"),o==0)f.addClass("hidden");else{f.removeClass("hidden");f.off("click");f.on("click",function(){l(o,!0,u)})}n("#single-engagement-modal").modal("show")})}function a(n,i){var u=t.posts.theme[i].indexOf(parseInt(n)),r;if(u+1<t.posts.theme[i].length)r=t.posts.theme[i][u+1],t.posts.viewed.indexOf(r)!=-1&&(r=a(r,i));else if(nextPostTheme=et(t.posts.theme,i),nextPostTheme)if(t.posts.theme[i].length==0)nextPostTheme=et(t.posts.theme,i);else if(current_id=t.posts.theme[nextPostTheme][0],t.posts.viewed.indexOf(current_id)!=-1)r=a(current_id,nextPostTheme);else return current_id;else r=0;return r}function yt(n,i){var u=t.posts.theme[i].indexOf(parseInt(n)),r;if(u-1<0)if(prevPostTheme=ot(t.posts.theme,i),prevPostTheme)if(t.posts.theme[i].length==0)prevPostTheme=ot(t.posts.theme,i);else return current_id=t.posts.theme[prevPostTheme].length;else r=0;else r=t.posts.theme[i][u-1];return r}function et(n,t){var i=Object.keys(n),u=i.indexOf(t),r=u+=1;return r>=i.length?!1:i[r]}function ot(n,t){var i=Object.keys(n),r=i.indexOf(t),u=r-=1;return r===0?!1:i[u]}function v(i,r,u){var e,f;if(i&&i.raw)for(t.posts.engagements[u][r]=[],e=0;e<i.raw.length;e++)f=i.raw[e].name,t.posts.engagements[u][r].push(f),t.posts[r][f]=t.posts[r][f]||[],n.inArray(u,t.posts[r][f])===-1&&t.posts[r][f].push(u)}function ti(r){if(r=r||n.noop,t.geoTID)r();else{t.geoTID={};var u=function(f){var e=100;i("get","https://engagements.missouri.edu/wp-json/wp/v2/muext_geoid",{per_page:e,page:f},function(i){n.each(i,function(n,i){t.GeoID[i.name]=i.id})});Response.length<e?(f++,u(f)):r()};u(1)}}function e(i,r){var u={},f=i.engagements;n.each(t.filters,function(e,o){var h,c,v,l,s,a,w;if(i[o]){u[o]={};h=n("#filter-"+o);h.empty();c=[];for(v in i[o])c.push(v);f&&c.sort();var y=!1,p={},b=e===0&&f;for(l=0;l<c.length;l++)s=c[l],i[o].hasOwnProperty(s)&&(a=n.isArray(i[o][s])?i[o][s].length:i[o][s],u[o][s]=a,w=b?n("<a />",{href:"javascript:void(0)"}):n("<span />"),h.append(n("<li />",{"data-id":s}).append(n("<i />",{"class":"fa fa-square-o fa-2x"})).append(w.append(s+" ("+a+")"))),y=!0,p[s]=i[o][s]);if(i[o]=p,r&&!y&&h.append(n("<li />").append(n("<i />",{"class":"fa fa-spinner fa-spin fa-2x"})).append(n("<span />").append(" Loading..."))),f)h.find("i").on("click",function(){var i,e,r,u,f;n(this).toggleClass("fa-square-o").toggleClass("fa-check-square");i="filter-active";e=n(this).parent();e.toggleClass(i);r={};n.each(t.filters,function(t,u){r[u]=[];var f=n("#filter-"+u);f.find("li."+i).each(function(){var t=n(this).attr("data-id");r[u].push(t)})});pt(r);u={};for(f in t.posts.theme)u[f]=t.posts.theme[f].length;st(t.posts,u);n.each(t.filters,function(r,u){var f=n("#filter-"+u),e=r===0?"a":"span",o=f.find("."+i).length===0;f.find("li").each(function(){var f=n(this).find(e),r=n(this).attr("data-id"),s=t.posts[u][r]?t.posts[u][r].length:0;(o||n(this).hasClass(i))&&(r+=" ("+s+")");f.html(r)})})})}});st(i,u.theme);n("#filter-theme").find("a").on("click",function(){var i=n(this).parent().attr("data-id"),t=n("#"+h(i));if(t.length)return n("html,body").animate({scrollTop:t.offset().top-135},1e3),!1})}function st(i,r){var f,o,s,e,u,c;lt();f=n("#engage-geog");switch(t.geoid.length){case 0:f.html("State of Missouri");break;case 1:case 2:case 3:o=[];n("#filter-geography").find("li").each(function(){o.push(n(this).find("span").html().replace(/ *\([^)]*\) */,""))});f.html(o.join(", "));break;default:f.html(t.igeog===0?"Selected Counties":"Selected "+t.geog[t.igeog].layer_name.split(" ")[0]+" Districts")}s=[];for(e in r)r[e]>0&&s.push({name:e,y:r[e]});if(Highcharts.chart("overview-chart",{chart:{type:"column",style:{fontFamily:"inherit"}},credits:{enabled:!1},title:null,xAxis:{type:"category",labels:{style:{fontSize:"1.25em"}}},yAxis:{title:{text:"Number of Engagements",style:{fontSize:"1.25em"}}},legend:{enabled:!1},tooltip:{headerFormat:"",pointFormat:'<span style="color:{point.color}">{point.name}<\/span>: <b>{point.y}<\/b>'},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y}"}}},series:[{colorByPoint:!0,data:s}]}),i.engagements){n("#engage-list").empty();for(u in i.theme)i.theme[u].length>0&&(c=h(u),n("#engage-list").append(n("<div />",{id:c+"_container","class":"row"}).append(n("<h4 />",{id:c,"class":"col-xs-12 modal-theme"}).append(u))),ht(0,u))}}function pt(i){var u=[],f,e,r,o;for(f in t.posts.engagements)e={id:f},n.each(t.filters,function(n,i){e[i]=t.posts.engagements[f][i]}),u.push(e);if(u=u.filter(function(n){for(var t in i)if(i[t].length>0&&!wt(i[t],n[t]))return!1;return!0}),n.each(t.filters,function(i,r){t.posts[r]={};n.each(u,function(i,u){n.each(u[r],function(i,f){t.posts[r][f]=t.posts[r][f]||[];n.inArray(u.id,t.posts[r][f])===-1&&t.posts[r][f].push(u.id)})})}),r=t.filters[0],i[r].length>0)for(o in t.posts[r])n.inArray(o,i[r])===-1&&(t.posts[r][o]=[])}function wt(n,t){var i=[];return i=n.filter(function(n){return t.indexOf(n)>=0}).concat(t.filter(function(t){return n.indexOf(t)>=0})),i.length>0}function ht(i,r){for(var f,u,c,a,e=i+6,v=h(r),p=n("#"+v+"_container"),w=n("#list-view").hasClass("active")?" list-group-item":"",o=t.posts.theme[r],k=t.posts.engagements,b=y("images"),s=i;s<Math.min(o.length,e);s++)if(f=o[s],t.posts.engagements.hasOwnProperty(f)){u=t.posts.engagements[f];u={title:u.title,link:u.link,image:u.image||b+v+".jpg"};c=ct(u,f,w,!1);c.on("click",function(){var t=n(this).attr("data-id");l(t,!0,r)});p.append(c)}if(o.length>e){a=n("<h2 />",{"class":"text-center show-more","data-id":e,"data-theme":r}).append(n("<i />",{"class":"fa fa-chevron-circle-down icon fa-2x",title:"Show more"}));a.on("click",function(){var t=parseInt(n(this).attr("data-id")),i=n(this).attr("data-theme");n(this).remove();ht(t,i)});p.append(a)}}function ct(t,i,r,u){var f=n("<div />",{"class":"single-engagement col-xs-12 col-lg-4 col-md-6 col-sm-6"+r,"data-id":i}).append(n("<div />",{"class":"engagement-item"}).append(n("<div />",{style:"background-image: url("+t.image+")","class":"img-container"})).append(n("<div />",{"class":"row"}).append(n("<div />",{"class":"text-below col-xs-12"}).append(n("<h3 />").append(t.title)))));return u&&(f=n("<a />",{href:t.link,target:"_blank"}).append(f)),f}function y(t){return n("#plugin-file-path").val()+t+"/"}function lt(){var i=t.geoid.length>0,r=i&&!n.isEmptyObject(t.posts.theme),u;n("#style-container").toggle(r);n("#engage-list").toggle(r);n("#impact-container").toggle(i&&t.igeog!==1);u=!i||r;n("#chart-container").toggle(u);n("#engage-container").toggle(u)}function bt(){var t={collapsed:!1,animation:!0,speed:"medium"};n("fieldset.collapsible").each(function(){var r=n(this),u=r.children("legend"),i=r.hasClass("collapsed");u.click(function(){p(r,t,!i);i=!i;n(this).find("i").toggleClass("fa-chevron-down",i).toggleClass("fa-chevron-up",!i)});i?p(r,{animation:!1},i):p(r,t,i)})}function p(n,t,i){$container=n.find("div");i?(t.animation?$container.slideUp(t.speed):$container.hide(),n.removeClass("expanded").addClass("collapsed")):(t.animation?$container.slideDown(t.speed):$container.show(),n.removeClass("collapsed").addClass("expanded"))}function at(){var t=n("#address-input").val();t!==""&&(/(mo$|mo |missouri$|missouri )/i.test(t)||(t+=", mo"),b.geocode().text(t).run(function(n,t){t&&t.results&&nt(t.results[0].latlng)}))}}}),function(){var n=function(){return function(){this.series=undefined;this.numClasses=null;this.breaks=undefined;this.range=undefined;this.statMethod=undefined;this.setSeries=function(n){this.series=Array();this.series=n;this.series=this.series.sort(function(n,t){return n-t})};this.setNumClasses=function(n){this.numClasses=n};this._classifyJenks=function(){for(var w,b,tt,t,f,h,k,d,it,e,rt,c,ut,s,n,ft,l,st,a,v,y,r,ht,p,i,o,ct,u=[],nt=0,lt=this.series.length+1;nt<lt;nt++){for(w=[],b=0,tt=this.numClasses+1;b<tt;b++)w.push(0);u.push(w)}for(t=[],f=0,h=this.series.length+1;f<h;f++){for(k=[],d=0,it=this.numClasses+1;d<it;d++)k.push(0);t.push(k)}for(e=1,rt=this.numClasses+1;e<rt;e++){for(u[0][e]=1,t[0][e]=0,c=1,ut=this.series.length+1;c<ut;c++)t[c][e]=Infinity;s=0}for(n=2,ft=this.series.length+1;n<ft;n++){var g=0,et=0,ot=0;for(l=1,st=n+1;l<st;l++)if(a=n-l+1,v=parseFloat(this.series[a-1]),et+=v*v,g+=v,ot+=1,s=et-g*g/ot,y=a-1,y!=0)for(r=2,ht=this.numClasses+1;r<ht;r++)t[n][r]>=s+t[y][r-1]&&(u[n][r]=a,t[n][r]=s+t[y][r-1]);u[n][1]=1;t[n][1]=s}for(p=this.series.length,i=[],f=0,h=this.numClasses+1;f<h;f++)i.push(0);for(i[this.numClasses]=parseFloat(this.series[this.series.length-1]),i[0]=parseFloat(this.series[0]),o=this.numClasses;o>=2;)ct=parseInt(u[p][o]-2),i[o-1]=this.series[ct],p=parseInt(u[p][o]-1),o-=1;return i[0]==i[1]&&(i[0]=0),this.range=i,this.range.sort(function(n,t){return n-t}),this.range};this.classify=function(n,t){this.statMethod=n!==undefined?n:this.statMethod;this.numClasses=t!==undefined?t:this.numClasses;var i=this._classifyJenks();return this.breaks=i,i};this.getBreaks=function(){return this.breaks?this.breaks:this.classify()};this._mean=function(n){return parseFloat(this._sum(n)/n.length)};this._sum=function(n){for(var i=0,t=0;t<n.length;t++)i+=n[t];return i};this._variance=function(n){for(var i=0,t=0;t<n.length;t++)i+=Math.pow(n[t]-this._mean(n),2);return i/n.length};this._stdDev=function(n){return Math.sqrt(this._variance(n))}}}();typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=n:window.classyBrew=n}();